define(["require","app/helpers/debugger","app/models/user","app/controllers/lightbox"],function(e,t,n,r){var i={};return i.load=function(e,n){var r,i=this;if($("#sr_sidebar_box").length===0)return t.log("#sr_sidebar_box is not found, cannot load sidebar."),!1;i=this,t.log("Loading the sidebar",0),e.logged_in===!0?(t.log("User is logged in"),e.auto_sharing===!0?r="sr_sidebar_toggled_on":r="sr_sidebar_toggled_off",t.log("User auto-sharing is set to: "+e.auto_sharing),t.log("Putting html"),$("#sr_sidebar_box").html("       <div id='sr_sidebar_logged_in'>               <a target='blank' href='"+e.link+"'>            <img src='"+e.picture+"' width='50' height='50' alt='"+e.name+"' />         </a>          <div id='sr_sidebar_right'>           <div id='sr_sidebar_name'><a target='blank' href='"+e.link+"'>"+e.name+"</a></div>            <div id='sr_sidebar_promo'>"+n.login_meta+"</div>           <div id='sr_sidebar_logout'><a>Logout</a></div>         </div>          <div class='clear'></div>         <div id='sr_sidebar_bottom'>            <div class='sr_sidebar_toggle "+r+"'>             <a title='Auto sharing to Facebook is enabled'>"+n.auto_sharing_on+"</a>            </div>            <div id='sr_sidebar_activity'><a>"+n.activity+"</a></div>         </div>        </div>      "),$("#sr_sidebar_box").html()!==""?t.log("Html put: SUCCESS"):t.log("Html put: FAILURE"),this.setup_logged_in_listeners()):(t.log("User is not logged in, show login button"),t.log("Putting html"),$("#sr_sidebar_box").html("       <div id='sr_sidebar_logged_out'>                Login and read with your friends          <a id='sr_sidebar_login'><img src='"+n.plugin_url+"/images/facebooklogin.jpg' width='180' height='40' /></a>        </div>      "),$("#sr_sidebar_box").html()!==""?t.log("Html put: SUCCESS"):t.log("Html put: FAILURE"),t.log("Adding jQuery listener for login button click"),this.setup_logged_out_listeners())},i.setup_logged_in_listeners=function(){var e=this;t.log("Setup jQuery listener for toggle auto-sharing link click"),$("#sr_sidebar_box .sr_sidebar_toggle").on("click",function(){e.toggle_auto_sharing($(this))}),t.log("Setup jQuery listener activity link click"),$("#sr_sidebar_box #sr_sidebar_activity").on("click",function(){r.show("all_activity",n)}),t.log("Setup jQuery listener for logout link click"),$("#sr_sidebar_box #sr_sidebar_logout").on("click",function(){n.logout()}),t.log("Finished")},i.setup_logged_out_listeners=function(){$("#sr_sidebar_box #sr_sidebar_login").on("click",function(){$(this).css("opacity",.7),n.login()})},i.toggle_auto_sharing=function(e){e.attr("class").match(/sr_sidebar_toggled_on/)?(e.removeClass("sr_sidebar_toggled_on"),e.addClass("sr_sidebar_toggled_off"),n.set_auto_sharing(!1)):e.attr("class").match(/sr_sidebar_toggled_off/)&&(e.removeClass("sr_sidebar_toggled_off"),e.addClass("sr_sidebar_toggled_on"),n.set_auto_sharing(!0))},i});