define("jquery",["https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"],function(){return jQuery.noConflict(!0)}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?null:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s},x.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return 0===t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var O=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=O(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&O(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return O(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=x.invert(M.escape);var _={escape:RegExp("["+x.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(M.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(_[e],function(t){return M[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,n.apply(x,e))}})};var D=0;x.uniqueId=function(e){var t=++D+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(B,function(e){return"\\"+H[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var j=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(e,t){typeof exports!="undefined"?t(e,exports,require("underscore")):typeof define=="function"&&define.amd?define("backbone",["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="0.9.10",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object")for(var i in n)e[t].apply(e,[i,n[i]].concat(r));else{if(!f.test(n))return!0;n=n.split(f),i=0;for(var s=n.length;i<s;i++)e[t].apply(e,[n[i]].concat(r))}},c=function(e,t){var n,r=-1,i=e.length;switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);break;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0]);break;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0],t[1]);break;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0],t[1],t[2]);break;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t)}},r=t.Events={on:function(e,t,n){return!l(this,"on",e,[t,n])||!t?this:(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this)},once:function(e,t,r){if(!l(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r),this},off:function(e,t,r){var i,s,o,u,a,f,c,h;if(!this._events||!l(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events={},this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++)if(e=u[a],i=this._events[e]){o=[];if(t||r)for(c=0,h=i.length;c<h;c++)s=i[c],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&o.push(s);this._events[e]=o}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},listenTo:function(e,t,r){var i=this._listeners||(this._listeners={}),s=e._listenerId||(e._listenerId=n.uniqueId("l"));return i[s]=e,e.on(t,typeof t=="object"?this:r,this),this},stopListening:function(e,t,n){var r=this._listeners;if(r){if(e)e.off(t,typeof t=="object"?this:n,this),!t&&!n&&delete r[e._listenerId];else{typeof t=="object"&&(n=this);for(var i in r)r[i].off(t,n,this);this._listeners={}}return this}}};r.bind=r.on,r.unbind=r.off,n.extend(t,r);var h=t.Model=function(e,t){var r,i=e||{};this.cid=n.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(i=this.parse(i,t)||{});if(r=n.result(this,"defaults"))i=n.defaults({},i,r);this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,r,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,u=r.silent,e=[],a=this._changing,this._changing=!0,a||(this._previousAttributes=n.clone(this.attributes),this.changed={}),l=this.attributes,f=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(l[i],t)||e.push(i),n.isEqual(f[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete l[i]:l[i]=t;if(!u){e.length&&(this._pending=!0),t=0;for(i=e.length;t<i;t++)this.trigger("change:"+e[t],this,l[e[t]],r)}if(a)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._changing=this._pending=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={},r;for(r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes,s;for(s in e)n.isEqual(i[s],t=e[s])||((r||(r={}))[s]=t);return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){if(!e.set(e.parse(n,r),r))return!1;t&&t(e,n,r)},this.sync("read",this,e)},save:function(e,t,r){var i,s,o=this.attributes;return e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,i&&(!r||!r.wait)&&!this.set(i,r)?!1:(r=n.extend({validate:!0},r),this._validate(i,r)?(i&&r.wait&&(this.attributes=n.extend({},o,i)),r.parse===void 0&&(r.parse=!0),s=r.success,r.success=function(e,t,r){e.attributes=o;var u=e.parse(t,r);r.wait&&(u=n.extend(i||{},u));if(n.isObject(u)&&!e.set(u,r))return!1;s&&s(e,t,r)},e=this.isNew()?"create":r.patch?"patch":"update",e==="patch"&&(r.attrs=i),e=this.sync(e,this,r),i&&r.wait&&(this.attributes=o),e):!1)},destroy:function(e){var e=e?n.clone(e):{},t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(e,t,n){(n.wait||e.isNew())&&i(),r&&r(e,t,n)};if(this.isNew())return e.success(this,null,e),!1;var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;var e=n.extend({},this.attributes,e),r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,t||{}),!1):!0}});var p=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))};n.extend(p.prototype,r,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){e=n.isArray(e)?e.slice():[e],t||(t={});var r,i,s,u,f,l,c,h,p,d;c=[],h=t.at,p=this.comparator&&h==null&&t.sort!=0,d=n.isString(this.comparator)?this.comparator:null;for(r=0,i=e.length;r<i;r++)(s=this._prepareModel(u=e[r],t))?(f=this.get(s))?t.merge&&(f.set(u===s?s.attributes:u,t),p&&!l&&f.hasChanged(d)&&(l=!0)):(c.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,s.id!=null&&(this._byId[s.id]=s)):this.trigger("invalid",this,u,t);c.length&&(p&&(l=!0),this.length+=c.length,h!=null?a.apply(this.models,[h,0].concat(c)):o.apply(this.models,c)),l&&this.sort({silent:!0});if(t.silent)return this;for(r=0,i=c.length;r<i;r++)(s=c[r]).trigger("add",s,this,t);return l&&this.trigger("sort",this,t),this},remove:function(e,t){e=n.isArray(e)?e.slice():[e],t||(t={});var r,i,s,o;for(r=0,i=e.length;r<i;r++)if(o=this.get(e[r]))delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o);return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(e!=null)return this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]},at:function(e){return this.models[e]},where:function(e){return n.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},update:function(e,t){t=n.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var r,i,s,o,u=[],a=[],f={};n.isArray(e)||(e=e?[e]:[]);if(t.add&&!t.remove)return this.add(e,t);for(i=0,s=e.length;i<s;i++)r=e[i],o=this.get(r),t.remove&&o&&(f[o.cid]=!0),(t.add&&!o||t.merge&&o)&&u.push(r);if(t.remove)for(i=0,s=this.models.length;i<s;i++)r=this.models[i],f[r.cid]||a.push(r);return a.length&&this.remove(a,t),u.length&&this.add(u,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){e[r.update?"update":"reset"](n,r),t&&t(e,n,r)},this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,t,n){n.wait&&r.add(e,n),i&&i(e,t,n)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){(e==="add"||e==="remove")&&n!==this||(e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,r){t||(t=this.comparator);var i=n.isFunction(t)?t:function(e){return e.get(t)};return n.sortedIndex(this.models,e,i,r)}}),n.each("forEach,each,map,collect,reduce,foldl,inject,reduceRight,foldr,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,toArray,size,first,head,take,initial,rest,tail,drop,last,without,indexOf,shuffle,lastIndexOf,isEmpty,chain".split(","),function(e){p.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}}),n.each(["groupBy","countBy","sortBy"],function(e){p.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var s=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,m=/\*\w+/g,g=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(s.prototype,r,{initialize:function(){},route:function(e,r,i){return n.isRegExp(e)||(e=this._routeToRegExp(e)),i||(i=this[r]),t.history.route(e,n.bind(function(n){n=this._extractParameters(e,n),i&&i.apply(this,n),this.trigger.apply(this,["route:"+r].concat(n)),this.trigger("route",r,n),t.history.trigger("route",this,r,n)},this)),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes)for(var e,t=n.keys(this.routes);(e=t.pop())!=null;)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(g,"\\$&").replace(d,"(?:$1)?").replace(v,function(e,t){return t?e:"([^/]+)"}).replace(m,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var y=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},b=/^[#\/]|\s+$/g,w=/^\/+|\/+$/g,E=/msie [\w.]+/,S=/\/$/;y.started=!1,n.extend(y.prototype,r,{interval:50,getHash:function(e){return(e=(e||this).location.href.match(/#(.*)$/))?e[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){var e=this.location.pathname,n=this.root.replace(S,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(b,"")},start:function(e){if(y.started)throw Error("Backbone.history has already been started");y.started=!0,this.options=n.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);var e=this.getFragment(),r=document.documentMode,r=E.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);this.root=("/"+this.root+"/").replace(w,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e,e=this.location,r=e.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!r)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&r&&e.hash&&(this.fragment=this.getHash().replace(b,""),this.history.replaceState({},document.title,this.root+this.fragment+e.search));if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),y.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe)));if(e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return n.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!y.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){n?(n=e.href.replace(/(javascript:|#).*$/,""),e.replace(n+"#"+t)):e.hash="#"+t}}),t.history=new y;var x=t.View=function(e){this.cid=n.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},T=/^(\S+)\s*(.*)$/,N="model,collection,el,id,attributes,className,tagName,events".split(",");n.extend(x.prototype,r,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=n.result(this,"events"))){this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)throw Error('Method "'+e[t]+'" does not exist');var i=t.match(T),s=i[1],i=i[2],r=n.bind(r,this);s+=".delegateEvents"+this.cid,i===""?this.$el.on(s,r):this.$el.on(s,i,r)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=n.extend({},n.result(this,"options"),e)),n.extend(this,n.pick(e,N)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(t.$("<"+n.result(this,"tagName")+">").attr(e),!1)}}});var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.sync=function(e,r,i){var s=C[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||k()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1);var a=i.success;i.success=function(e){a&&a(r,e,i),r.trigger("sync",r,e,i)};var f=i.error;return i.error=function(e){f&&f(r,e,i),r.trigger("error",r,e,i)},e=i.xhr=t.ajax(n.extend(o,i)),r.trigger("request",r,e,i),e},t.ajax=function(){return t.$.ajax.apply(t.$,arguments)},h.extend=p.extend=s.extend=x.extend=y.extend=function(e,t){var r=this,i;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};var k=function(){throw Error('A "url" property or function must be specified')};return t}),define("app/modules/cache",["require","backbone"],function(e){var t=e("backbone");return t.Model.extend({exists:function(){return window.localStorage.getItem(this.get("name"))!==null&&window.localStorage.getItem(this.get("name")+"_last_update")!==null?!0:!1},is_recent:function(){if(this.exists()===!1)return!1;var e=window.localStorage.getItem(this.get("name")+"_last_update"),t=((new Date).getTime()-e)/1e3;return t<600?!0:!1},save:function(e){window.localStorage.setItem(this.get("name"),JSON.stringify(e)),window.localStorage.setItem(this.get("name")+"_last_update",(new Date).getTime())},fetch:function(){var e=window.localStorage.getItem(this.get("name"));try{return JSON.parse(e)}catch(t){return!1}},wipe:function(){delete window.localStorage[this.get("name")],delete window.localStorage[this.get("name")+"_last_update"]}})}),define("app/core/global",["require","underscore","backbone","../modules/cache"],function(e){var t=e("underscore"),n=e("backbone"),r=e("../modules/cache"),i=new r({name:"social_reader_cache"}),s=n.Model.extend({defaults:{options:{},auto_sharing:!0,user:{},activity:[],friends:[]},initialize:function(){this.setup_cache(),this.set_preset_values(),this.cache_on_change()},setup_cache:function(){this.set("is_cached",i.exists()),this.set("is_cached_recently",i.is_recent()),this.get("is_cached")&&(this.attributes=t.extend(this.attributes,i.fetch()))},cache_on_change:function(){var e=this;this.on("change",function(){i.save(t.omit(e.attributes,["is_cached","is_cached_recently"]))})},set_preset_values:function(){this.set("options",t.clone(window._sr))}});return window._sr=new s,window._sr}),define("app/modules/facebook/sort",[],function(){return function(e,t,n){return n===undefined?e=e.sort():e=e.sort(function(e,t){var r=e[n],i=t[n];return r<i?-1:r>i?1:0}),(t||"asc")=="desc"&&(e=e.reverse()),e}}),define("app/modules/facebook/fb",["require","jquery","underscore","backbone","./sort"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone"),i=e("./sort"),s=r.Model.extend({start:function(e){var n=this;if(!this.get("app_id"))return!1;this.get("sdk_disabled")===!0?(this.sdk_check_count=0,this.wait_for_fb(function(){e()})):(t("#fb-root").length===0&&t("body").prepend('<div id="fb-root"></div>'),window.fbAsyncInit=function(){FB.init({appId:n.get("app_id"),channelUrl:n.get("channel_url"),status:!0,cookie:!0,xfbml:!0}),e()},function(e,t){var n,r,i;r=void 0,n="facebook-jssdk",i=e.getElementsByTagName("script")[0];if(e.getElementById(n))return;return r=e.createElement("script"),r.id=n,r.async=!0,r.src="//connect.facebook.net/en_US/all"+(t?"/debug":"")+".js",i.parentNode.insertBefore(r,i)}(window.document,!1))},wait_for_fb:function(e){this.sdk_check_count++;if(this.sdk_check_count>10)return;var n=this;window.FB?t("#fb-root").length===1?e():setTimeout(function(){n.wait_for_fb()},100):setTimeout(function(){n.wait_for_fb()},100)},is_logged_in:function(e){FB.getLoginStatus(function(t){e(t.status==="connected"?!0:!1)})},get_data:function(e){var t=this;t.get_user(function(){t.get_friends(function(){t.get_activity(function(){e(t.get("user"),t.get("friends"),t.get("activity"))})})})},get_user:function(e){var t=this;FB.api("/me",function(n){n.picture="//graph.facebook.com/"+n.id+"/picture",t.set("user",n),e()})},get_friends:function(e){var t=this;FB.api("/me/friends?fields=id,name,installed",function(n){t.set("friends",n.data),e()})},get_friends_appusers:function(){var e=[];return n.each(this.get("friends"),function(t){t.installed===!0&&e.push(t)}),e},get_activity:function(e){var t=this,r=[];r.push({method:"GET",user_id:this.get("user").id,relative_url:"me/"+this.get("action_type")+"?fields=id,comment_info,comments,comment_info,likes,like_info,data,publish_time,from"}),n.each(this.get_friends_appusers(),function(e){r.push({method:"GET",user_id:e.id,relative_url:e.id+"/"+t.get("action_type")+"?fields=id,comment_info,comments,comment_info,likes,like_info,data,publish_time,from"})}),FB.api("/","POST",{batch:r},function(r){var i=[];n.each(r,function(e,t){if(!e||!e.body)return;var n=JSON.parse(e.body);i.push(n)}),t.set("activity",i),e()})},login:function(e){var t=this;FB.login(function(t){t.status==="connected"&&e()},{scope:"publish_actions"})},logout:function(e){FB.logout(function(t){e()})},add_read:function(e){FB.api("/me/"+this.get("action_type")+"?article="+window.location.href,"post",function(t){e(t.id?t.id:!1)})},refresh_my_activity:function(){FB.api("me/"+this.get("action_type")+"?fields=id,comment_info,comments,comment_info,likes,like_info,data,publish_time,from",function(e){window._sr.activity[0]=e})},delete_read:function(e,t,r){FB.api("/"+e,"delete",function(i){i===!0&&n.each(t[0].data,function(t,n){t.id==e&&delete window._sr.activity[0].data[n]}),r()})},put_all_reads_in_one_array:function(e){var t=[];return n.each(e,function(e){n.each(e.data,function(e){t.push(e)})}),i(t,"desc","publish_time")}});return new s}),define("app/core/user",["require","backbone","./global","../modules/facebook/fb"],function(e){var t=e("backbone"),n=e("./global"),r=e("../modules/facebook/fb"),i=t.Model.extend({initialize:function(){r.set(n.get("options").facebook)},start:function(e){var t=this;r.start(function(){r.is_logged_in(function(t){t&&(n.get("is_cached_recently")===!1?r.get_data(function(t,r,i){n.set({user:t,friends:r,activity:i}),e()}):e())})})},login:function(){r.login(function(){window.location.reload()})},logout:function(e){r.logout(function(){e()})}});return new i}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=[],i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},s=function(e,t){var n=i,r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(n.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"; __p.push('"}).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"")+"');}return __p.join('');";return r};define("tpl",[],function(){var i,o,u;return typeof window!="undefined"&&window.navigator&&window.document?o=function(e,t){var n=i.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node&&(u=require.nodeRequire("fs"),o=function(e,t){t(u.readFileSync(e,"utf8"))}),i={version:"0.24.0",strip:function(e){if(e){e=e.replace(t,"");var r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"").replace(/[\t]/g,"").replace(/[\r]/g,"")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw new Error("require.getXhr(): XMLHttpRequest not available");return t},get:o,load:function(e,t,n,o){var u=!1,a,f=e.indexOf("."),l=e.substring(0,f),c=e.substring(f+1,e.length);f=c.indexOf("!"),f!==-1&&(u=c.substring(f+1,c.length),u=u==="strip",c=c.substring(0,f)),a="nameToUrl"in t?t.nameToUrl(l,"."+c):t.toUrl(l+"."+c),i.get(a,function(t){t=s(t),o.isBuild||(t=new Function("obj",t)),t=u?i.strip(t):t,o.isBuild&&o.inlineText&&(r[e]=t),n(t)})},write:function(e,t,n){if(t in r){var s=i.jsEscape(r[t]);n("define('"+e+"!"+t+"', function() {return function(obj) { "+s.replace(/(\\')/g,"'").replace(/(\\\\)/g,"\\")+"}});\n")}}}})}(),define("tpl!app/core/widgets/global.css",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("body {  font-family:arial;  font-size:12px;}a {  color: #3B5998;  cursor:pointer;}a:hover {  text-decoration:underline;}");return __p.join("")}}),define("app/core/widgets/widget",["require","backbone","underscore","jquery","tpl!./global.css"],function(e){var t=e("backbone"),n=e("underscore"),r=e("jquery"),i=e("tpl!./global.css");return t.View.extend({load:function(){this.create_iframe(),this.load_css(i)},create_iframe:function(){if(this.$container.html()===""){var e=r("<iframe />",{border:0});this.$container.html(e),this.setElement(e.contents())}},load_css:function(e){var t=r("<style />",{type:"text/css",html:e()});this.$el.find("head").append(t)}})}),define("app/core/widgets/lightbox/time",[],function(){var e={};return e.relative=function(e){var t,n,r,i,s,o,u;return u=(new Date(e)).getTime(),i=6e4,r=i*60,n=r*24,s=n*30,o=n*365,t=(new Date).getTime()-u,t<i?Math.round(t/1e3)+" seconds ago":t<r?Math.round(t/i)+" minutes ago":t<n?Math.round(t/r)+" hours ago":t<s?Math.round(t/n)+" days ago":t<o?Math.round(t/s)+" months ago":Math.round(t/o)+" years ago"},e}),define("tpl!app/core/widgets/lightbox/lightbox.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<h3>Recent activity</h3><a id='sr_close_lightbox'>Close</a><div id='sr_loading'>  <img src='",site.plugin_url,"/images/ajax-loader.gif' alt='Loading...'></div><ul id='sr_activity_tabs'>  <li id='sr_lightbox_everyone' class='sr_active_tab'><a>Everyone</a></li>  <li id='sr_lightbox_me'><a>Just you</a></li></ul><div id='sr_reads_list'>  <ul>  </ul>  <div id='sr_reads_empty'>    None of your friends have read anything on this site yet.  </div></div>");return __p.join("")}}),define("tpl!app/core/widgets/lightbox/lightbox-read.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),from.id===window._sr.user.id?story_type="sr_me_story":story_type="sr_friend_story",__p.push("<li id='sr_read_",id,"' class='",story_type,"'>  <a class='name' href='//facebook.com/",from.id,"' target='blank'>    <img class='story-img' src='https://graph.facebook.com/",from.id,"/picture' width='50' height='50' alt='",from.name,"' />  </a><div class='story-inner'>  <div class='story-title'>    <a class='name' href='//facebook.com/profile.php?id=",from.id,"' target='blank'>",from.name,"</a>     read     <a class='article' href='",data.article.url,"' target='blank'>",data.article.title,"</a>  </div>  <div class='story-meta'>",relative_time," <span class='sr_story_delete_text'>&middot; <a class='sr_story_delete'>Delete</a></span>  </div></div><div class='sr_clear'></div></li>");return __p.join("")}}),define("app/core/widgets/lightbox/lightbox",["require","jquery","./time","underscore","../../global","../widget","tpl!./lightbox.html","tpl!./lightbox-read.html"],function(e){var t=e("jquery"),n=e("./time"),r=e("underscore"),i=e("../../global"),s=e("../widget"),o=e("tpl!./lightbox.html"),u=e("tpl!./lightbox-read.html");return s.extend({initialize:function(){if(!i.get("user"))return!1;t("<div/>",{id:"sr_lightbox",html:"<div id='sr_lightbox_inner'></div>"}).prependTo("body"),t("#sr_lightbox_inner").length!==0},setup_listeners:function(){var e=this;t("a#sr_close_lightbox").on("click",function(){return e.close()})},show:function(e,n){var r=this;return t("#sr_lightbox").fadeIn("fast",function(){r.show_activity(e,n),r.setup_listeners(),Analytics.setup_listeners("lightbox")})},close:function(){if(this.closing===!0)return;this.closing=!0;var e=this;return t("#sr_lightbox").fadeOut(function(){t("#sr_lightbox #sr_lightbox_inner").html(""),delete e.closing})},show_activity:function(){var e=this,s=r.template(o),a=s(i.attributes);t("#sr_lightbox_inner").html(a);var f=Fb.put_all_reads_in_one_array(i.get("activity").reads);t("#sr_loading").hide();if(!f||!f.length)t("#sr_reads_list").show(),t("#sr_reads_list #sr_reads_empty").show();else{var l="",c=r.template(u);r.each(f,function(e){if(!e.data||!e.data.article||!e.publish_time)return;e.relative_time=n.relative(e.publish_time),l+=c(e)}),t("#sr_reads_list ul").html(l),t("#sr_activity_tabs").show(),t("#sr_reads_list").show(),t("#sr_activity_tabs a").on("click",function(){t("#sr_activity_tabs li").removeClass("sr_active_tab"),t(this).closest("li").addClass("sr_active_tab"),t(this).closest("li").attr("id")==="sr_lightbox_everyone"?t("#sr_reads_list ul li").show():t(this).closest("li").attr("id")==="sr_lightbox_me"&&t("#sr_reads_list ul li.sr_friend_story").hide()}),t(".sr_story_delete").on("click",function(){var e;return e=t(this).closest("li").attr("id").replace("sr_read_",""),Fb.delete_read(e,function(n){return t("#sr_read_"+e).fadeOut(function(){return t("#sr_read_"+e).remove()})})})}}})}),define("tpl!app/core/widgets/sidebar/logged_in.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='logged_in'>  <a class='profile' target='blank' href='",user.link,"'><img src='",user.picture,"' width='50' height='50' alt='",user.name,"'/></a>  <div class='right'>    <div class='name'>      <a target='blank' href=\"",user.link,'" >',user.name,"</a>    </div>    <div class='promo'>",options.login_meta,"</div>    <div class='logout'><a>",options.logout,"</a></div>  </div>  <div class='clear'>  </div>  <div class='bottom'>    "),auto_sharing?__p.push("      <div class='toggle toggled_on'>        <a>",options.auto_sharing_on,"</a>      </div>    "):__p.push("      <div class='toggle toggled_off'>        <a>",options.auto_sharing_off,"</a>      </div>    "),__p.push("    <div class='activity'>      <a>",options.activity,"</a>    </div>  </div></div>");return __p.join("")}}),define("tpl!app/core/widgets/sidebar/logged_out.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div id='sr_sidebar_logged_out'>  <p>",site.login_promo,"</p>  <a id='sr_sidebar_login'><img src='",site.plugin_url,"/images/facebooklogin.jpg' width='180' height='40'/></a></div>");return __p.join("")}}),define("tpl!app/core/widgets/sidebar/style.css",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("/*   === Sidebar (not logged in) === */.logged_out {  text-align:center;  margin-top:10px;  margin-bottom:10px;  color:#333;  font-weight:bold;  margin-bottom:15px;  font-size:14px;}.logged_out .login a {  }/*   === Sidebar (logged in) === */.logged_in {  margin-bottom:5px;  clear:both;}.logged_in img {  float:left;  margin-right:10px;  border:none;}.right {  margin-left:62px;}.logged_in .name {  font-weight:bold;  margin-bottom:4px;  font-size:14px;}.logged_in a {  font-weight:bold;  cursor:pointer;  color:#3B5998;  text-decoration:none;}.logged_in .toggle a {  margin-right:10px;}.logged_in .promo {  color:#777;  font-size:12px;  margin:2px 0 0 0;}.logged_in .logout {  margin-top:4px;}.logged_in .logout a {  font-weight:normal;}.logged_in .bottom {  margin:10px 0 0 0;}.logged_in .toggle {  display:inline-block;  padding-left:23px;  height:20px;} .logged_in .toggled_on {  background:url(../images/fbpublishing.png) no-repeat;}.logged_in .toggled_off {  background:url(../images/fbnotpublishing.png) no-repeat;}.logged_in .toggle a {  padding:0px;}.logged_in .activity {  display:inline-block;}.logged_in .activity a {  display:inline;}");return __p.join("")}}),define("app/core/widgets/sidebar/sidebar",["require","jquery","../widget","../../user","../lightbox/lightbox","../../global","tpl!./logged_in.html","tpl!./logged_out.html","tpl!./style.css"],function(e){var t=e("jquery"),n=e("../widget");User=e("../../user"),Lightbox=e("../lightbox/lightbox"),SR=e("../../global");var r=e("tpl!./logged_in.html"),i=e("tpl!./logged_out.html"),s=e("tpl!./style.css");return n.extend({initialize:function(){this.$container=t("#sr_sidebar_box");if(this.$container.length===0)return;this.load(),this.load_css(s),this.render()},render:function(){var e;if(SR.get("user")){var t=SR.get("auto_sharing")===!0?"auto_sharing_on":"auto_sharing_off";e=r(SR.attributes),this.$el.find("body").html(e)}else e=i(SR.attributes),this.$el.find("body").html(e)},events:{"click .toggle":"toggle_auto_sharing","click .activity":"show_lightbox","click .logout":"logout","click .login":"login"},login:function(e){$button=t(e.currentTarget),$button.css("opacity",.7),User.login()},toggle_auto_sharing:function(e){var n=t(e.currentTarget),r=n.hasClass("toggled_on")?!1:n.hasClass("toggled_off")?!0:!1,i=r===!0?SR.get("options").auto_sharing_on:SR.get("options").auto_sharing_off;n.toggleClass("toggled_on toggled_off"),n.find("a").text(i),SR.set("auto_sharing",r)},show_lightbox:function(){debugger},logout:function(){User.logout(function(){window.location.reload()})}})}),define("app/core/widgets/single/format",["require","underscore"],function(e,t){var n={};return n.names_list=function(e,t){var n=this;this.user=e,t=this.check(t,e),this.reads=t,count=this.reads.length;var r="";return r+='<div class="sr_read_names">',count===0?r+="None of your friends have read this yet":count===1?r+=this.name(t[0],e)+" read this":count===2?r+=this.name(t[0],e)+" and "+this.name(t[1],e)+" read this":count===3?(r+=this.name(t[0],e)+", ",r+=this.name(t[1],e)+" and ",r+=this.name(t[2],e)+" read this"):(r+=this.name(t[0],e)+", ",r+=this.name(t[1],e)+" and ",r+=count-2+" others read this"),r+="</div>",r},n.name=function(e,t){return!e.from||!e.from.id||!e.from.name||!t.id?"":e.from.id===t.id?"You":'<a target="blank" href="//facebook.com/'+e.from.id+'">'+e.from.name+"</a>"},n.thumbs_list=function(e,n){n=this.check(n,e);var r="";return r+='<div class="sr_read_thumbs">',t.each(n,function(e){r+='<a target="blank" href="//facebook.com/'+e.from.id+'" title="'+e.from.name+'">',r+="<img src='//graph.facebook.com/"+e.from.id+"/picture' width='35' height='35' alt='"+e.from.name+"' />",r+="</a>"}),r+="</div>",r},n.check=function(e,n){var r=[];return e=t.filter(e,function(e){if(t.indexOf(r,e.from.id)===-1)return r.push(e.from.id),!0}),e=t.sortBy(e,function(e){return e.from.id==n.id?1:2}),e},n}),define("app/core/widgets/single/single",["require","jquery","underscore","../widget","./format"],function(e){var t=e("jquery"),n=e("underscore"),r=e("../widget"),i=e("./format");return r.extend({initialize:function(){var e=window._sr.user,r=window._sr.activity;if(!e)return;if(t("#sr_friends_single").length!==0){if(!r)return;var s=Fb.put_all_reads_in_one_array(),o=n.filter(s,function(e){var t=new RegExp(window.location.pathname,"gi");if(!e.data||!e.data.article||!e.data.article.url)return!1;if(t.test(e.data.article.url))return!0}),u=i.names_list(e,o),a=i.thumbs_list(e,o),f=u+a}}})}),define("app/core/widgets/init",["require","underscore","./sidebar/sidebar","./single/single","./lightbox/lightbox"],function(e){var t=e("underscore"),n={sidebar:e("./sidebar/sidebar"),single:e("./single/single"),lightbox:e("./lightbox/lightbox")};return function(e){t.each(e,function(e){n[e]&&t.isFunction(n[e])&&new n[e]})}}),define("app/main",["require","jquery","./core/user","./core/widgets/init"],function(e){var t=e("jquery"),n=e("./core/user"),r=e("./core/widgets/init");t(document).ready(function(){n.start(function(){r(["sidebar","lightbox","single"])})})});var appUrl=require.toUrl("app"),arr=appUrl.split("/");arr.pop();var dir=arr.join("/");requirejs.config({baseUrl:dir+"/lib",paths:{app:dir+"/app",ga:"https://google-analytics.com/ga"}}),requirejs(["app/main"]),define("app",function(){});